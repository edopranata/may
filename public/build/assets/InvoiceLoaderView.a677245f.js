import{g as k,u as N,h as D,z as F,c as d,a as n,b as s,e as T,i as b,x as S,d as e,_,f as u,w as C,y as v,t as l,j as m,F as y,n as M,G as V,o as c,H as U,Q as j,J as B,R,S as $}from"./app.1b38ef22.js";import{_ as O}from"./Breadcrumb.cb73cb46.js";import{_ as H}from"./PageTitle.0dcaf6ba.js";import{s as P}from"./library.2a2b5b59.js";const A={for:"modal-option",class:"modal cursor-pointer modal-lg"},L={class:"modal-box w-11/12 max-w-3xl",for:""},z={class:"flex justify-between"},E={class:"px-6 w-full"},G={class:"card w-full rounded-none border-2 border-info shadow-xl"},J={class:"card-body"},K={class:"flex justify-between space-x-4 items-start"},Q={class:"grid md:grid-cols-2 gap-4 print:hidden"},q={class:"form-control w-full col-span-2"},W=e("label",{class:"label"},"No Nota / Invoice",-1),X={key:0,class:"label"},Y={class:"label-text-alt text-error"},Z={class:"form-control w-full"},ee=e("label",{class:"label"},"Tanggal Nota / Invoice",-1),te=["readonly"],se={key:0,class:"label"},ae={class:"label-text-alt text-error"},oe={class:"form-control w-full"},le=e("label",{class:"label"},"Upah Muat",-1),re={key:0,class:"label"},ne={class:"label-text-alt text-error"},ie={class:"flex justify-between col-span-2"},de={class:"grid text-sm grid-cols-1 w-[50%] print:w-[100%]"},ce=V('<div class="grid grid-cols-5"><span class="font-bold text-center px-4 py-2 border-l border-y col-span-2">Tanggal / Keterangan</span><span class="font-bold text-center px-4 py-2 border-l border-y">Banyaknya</span><span class="font-bold text-center px-4 py-2 border-l border-y">Harga</span><span class="font-bold text-center px-4 py-2 border-x border-y">Total</span></div><div class="grid grid-cols-5"><span class="px-4 py-2 border-l font-bold col-span-2">Pembelian Sawit</span><span class="px-4 py-2 border-l"></span><span class="px-4 py-2 border-l"></span><span class="px-4 py-2 border-x"></span></div>',2),pe={class:"px-4 border-l col-span-2"},ue={class:"px-4 border-l text-right"},be={class:"px-4 border-l text-right"},_e={class:"px-4 border-x text-right"},me={class:"grid grid-cols-5 border-y font-bold"},fe=e("span",{class:"px-4 py-2 border-l text-right col-span-4"},"Total Diterima",-1),xe={class:"px-4 py-2 border-x text-right"},Ie={__name:"InvoiceLoaderView",props:{dates:Object,loader:Object,trades:Array},setup(h){const r=h,g=[{url:route("transaction.index"),label:"Transaksi"},{url:route("transaction.invoice.index"),label:"Invoice"},{url:route("transaction.invoice.loader.index"),label:"Upah Muat"},{url:null,label:r.dates.start+" - "+r.dates.end}],p=k(!1),t=N({print:!1,invoice_date:"",invoice_number:"OTOMATIS",loader_id:r.loader.id,trades:r.trades,loader_fee:r.loader.price?r.loader.price.value:0,total:0}),f=()=>{t.patch(route("transaction.invoice.loader.update",r.loader.id),{onFinish:()=>{p.value=!1}})},w=()=>{t.print=!1,f()},I=()=>{t.print=!0,f()};D(()=>{x()}),F(()=>$.cloneDeep(t),(i,a)=>{i.loader_fee&&x()});const x=()=>{let i=t.trades.reduce((a,o)=>(a.push(o.net_weight*t.loader_fee),a),[]);i=i.reduce((a,o)=>a+=o,0),t.total=i};return(i,a)=>(c(),d(y,null,[n(s(U),{title:"Upah Muat"}),n(O,{links:g}),n(H,{classes:"bg-base-content",class:""},{default:T(()=>[u("Upah Muat ")]),_:1}),b(e("input",{type:"checkbox",id:"modal-option","onUpdate:modelValue":a[0]||(a[0]=o=>p.value=o),class:"modal-toggle"},null,512),[[S,p.value]]),e("label",A,[e("label",L,[e("div",z,[e("button",{type:"button",onClick:w,class:"btn btn-primary"},[n(_,{path:s(j)},null,8,["path"]),u(" Simpan")]),e("button",{type:"button",onClick:I,class:"btn btn-success"},[n(_,{path:s(B)},null,8,["path"]),u(" Simpan dan Print Invoice")]),e("button",{type:"button",onClick:a[1]||(a[1]=o=>p.value=!1),class:"btn btn-warning"},[n(_,{path:s(R)},null,8,["path"]),u(" Batal")])])])]),e("section",E,[e("div",G,[e("div",J,[e("div",K,[e("form",{onSubmit:a[6]||(a[6]=C(()=>{},["prevent"])),class:"w-[50%]"},[e("div",Q,[e("div",q,[W,b(e("input",{disabled:"","onUpdate:modelValue":a[2]||(a[2]=o=>s(t).invoice_number=o),type:"text",placeholder:"No Nota / Invoice",class:"input input-bordered w-full"},null,512),[[v,s(t).invoice_number]]),s(t).errors.invoice_number?(c(),d("label",X,[e("span",Y,l(s(t).errors.invoice_number),1)])):m("",!0)]),e("div",Z,[ee,b(e("input",{readonly:s(t).processing,"onUpdate:modelValue":a[3]||(a[3]=o=>s(t).invoice_date=o),type:"date",placeholder:"Tanggal Nota / Invoice",class:"input input-bordered w-full"},null,8,te),[[v,s(t).invoice_date]]),s(t).errors.invoice_date?(c(),d("label",se,[e("span",ae,l(s(t).errors.invoice_date),1)])):m("",!0)]),e("div",oe,[le,n(s(P),{options:{precision:0,prefix:"Rp ",isInteger:!0},readonly:s(t).processing,value:s(t).loader_fee,"onUpdate:value":a[4]||(a[4]=o=>s(t).loader_fee=o),class:"input input-bordered w-full"},null,8,["readonly","value"]),s(t).errors.loader_fee?(c(),d("label",re,[e("span",ne,l(s(t).errors.loader_fee),1)])):m("",!0)]),e("div",ie,[e("button",{type:"submit",onClick:a[5]||(a[5]=o=>p.value=!0),class:"btn btn-primary"},"Simpan")])])],32),e("div",de,[ce,(c(!0),d(y,null,M(s(t).trades,(o,ve)=>(c(),d("div",{class:"grid grid-cols-5",key:o.id},[e("span",pe,l(o.trade_date),1),e("span",ue,l(Intl.NumberFormat("id-ID",{style:"unit",unit:"kilogram"}).format(o.net_weight)),1),e("span",be,l(Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s(t).loader_fee)),1),e("span",_e,l(Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(o.net_weight*s(t).loader_fee)),1)]))),128)),e("div",me,[fe,e("span",xe,l(Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s(t).total)),1)])])])])])])],64))}};export{Ie as default};
