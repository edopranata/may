import{g as k,u as N,h as D,z as F,c as d,a as r,b as s,e as T,i as b,x as S,d as e,_,f as u,w as C,y as v,t as l,j as m,F as h,n as M,G as V,o as c,H as U,Q as j,J as B,R,S as $}from"./app.f33b5c0d.js";import{_ as O}from"./Breadcrumb.de4c8a73.js";import{_ as H}from"./PageTitle.dd8debfd.js";import{s as P}from"./library.595eb791.js";const A={for:"modal-option",class:"modal cursor-pointer modal-lg"},L={class:"modal-box w-11/12 max-w-3xl",for:""},z={class:"flex justify-between"},E=["disabled"],G=["disabled"],J=["disabled"],K={class:"px-6 w-full"},Q={class:"card w-full rounded-none border-2 border-info shadow-xl"},q={class:"card-body"},W={class:"flex justify-between space-x-4 items-start"},X={class:"grid md:grid-cols-2 gap-4 print:hidden"},Y={class:"form-control w-full col-span-2"},Z=e("label",{class:"label"},"No Nota / Invoice",-1),ee={key:0,class:"label"},te={class:"label-text-alt text-error"},se={class:"form-control w-full"},oe=e("label",{class:"label"},"Tanggal Nota / Invoice",-1),ae=["readonly"],le={key:0,class:"label"},ne={class:"label-text-alt text-error"},re={class:"form-control w-full"},ie=e("label",{class:"label"},"Upah Muat",-1),de={key:0,class:"label"},ce={class:"label-text-alt text-error"},pe={class:"flex justify-between col-span-2"},ue={class:"grid text-sm grid-cols-1 w-[50%] print:w-[100%]"},be=V('<div class="grid grid-cols-5"><span class="font-bold text-center px-4 py-2 border-l border-y col-span-2">Tanggal / Keterangan</span><span class="font-bold text-center px-4 py-2 border-l border-y">Banyaknya</span><span class="font-bold text-center px-4 py-2 border-l border-y">Harga</span><span class="font-bold text-center px-4 py-2 border-x border-y">Total</span></div><div class="grid grid-cols-5"><span class="px-4 py-2 border-l font-bold col-span-2">Pembelian Sawit</span><span class="px-4 py-2 border-l"></span><span class="px-4 py-2 border-l"></span><span class="px-4 py-2 border-x"></span></div>',2),_e={class:"px-4 border-l col-span-2"},me={class:"px-4 border-l text-right"},fe={class:"px-4 border-l text-right"},xe={class:"px-4 border-x text-right"},ve={class:"grid grid-cols-5 border-y font-bold"},he=e("span",{class:"px-4 py-2 border-l text-right col-span-4"},"Total Diterima",-1),ye={class:"px-4 py-2 border-x text-right"},De={__name:"InvoiceLoaderView",props:{dates:Object,loader:Object,trades:Array},setup(y){const n=y,g=[{url:route("transaction.index"),label:"Transaksi"},{url:route("transaction.invoice.index"),label:"Invoice"},{url:route("transaction.invoice.loader.index"),label:"Upah Muat"},{url:null,label:n.dates.start+" - "+n.dates.end}],p=k(!1),t=N({print:!1,invoice_date:"",invoice_number:"OTOMATIS",loader_id:n.loader.id,trades:n.trades,loader_fee:n.loader.price?n.loader.price.value:0,total:0}),f=()=>{t.patch(route("transaction.invoice.loader.update",n.loader.id),{onFinish:()=>{p.value=!1}})},w=()=>{t.print=!1,f()},I=()=>{t.print=!0,f()};D(()=>{x()}),F(()=>$.cloneDeep(t),(i,o)=>{i.loader_fee&&x()});const x=()=>{let i=t.trades.reduce((o,a)=>(o.push(a.net_weight*t.loader_fee),o),[]);i=i.reduce((o,a)=>o+=a,0),t.total=i};return(i,o)=>(c(),d(h,null,[r(s(U),{title:"Upah Muat"}),r(O,{links:g}),r(H,{classes:"bg-base-content",class:""},{default:T(()=>[u("Upah Muat ")]),_:1}),b(e("input",{type:"checkbox",id:"modal-option","onUpdate:modelValue":o[0]||(o[0]=a=>p.value=a),class:"modal-toggle"},null,512),[[S,p.value]]),e("label",A,[e("label",L,[e("div",z,[e("button",{type:"button",disabled:s(t).processing,onClick:w,class:"btn btn-primary"},[r(_,{path:s(j)},null,8,["path"]),u(" Simpan")],8,E),e("button",{type:"button",disabled:s(t).processing,onClick:I,class:"btn btn-success"},[r(_,{path:s(B)},null,8,["path"]),u(" Simpan dan Print Invoice")],8,G),e("button",{type:"button",disabled:s(t).processing,onClick:o[1]||(o[1]=a=>p.value=!1),class:"btn btn-warning"},[r(_,{path:s(R)},null,8,["path"]),u(" Batal")],8,J)])])]),e("section",K,[e("div",Q,[e("div",q,[e("div",W,[e("form",{onSubmit:o[6]||(o[6]=C(()=>{},["prevent"])),class:"w-[50%]"},[e("div",X,[e("div",Y,[Z,b(e("input",{disabled:"","onUpdate:modelValue":o[2]||(o[2]=a=>s(t).invoice_number=a),type:"text",placeholder:"No Nota / Invoice",class:"input input-bordered w-full"},null,512),[[v,s(t).invoice_number]]),s(t).errors.invoice_number?(c(),d("label",ee,[e("span",te,l(s(t).errors.invoice_number),1)])):m("",!0)]),e("div",se,[oe,b(e("input",{readonly:s(t).processing,"onUpdate:modelValue":o[3]||(o[3]=a=>s(t).invoice_date=a),type:"date",placeholder:"Tanggal Nota / Invoice",class:"input input-bordered w-full"},null,8,ae),[[v,s(t).invoice_date]]),s(t).errors.invoice_date?(c(),d("label",le,[e("span",ne,l(s(t).errors.invoice_date),1)])):m("",!0)]),e("div",re,[ie,r(s(P),{options:{precision:0,prefix:"Rp ",isInteger:!0},readonly:s(t).processing,value:s(t).loader_fee,"onUpdate:value":o[4]||(o[4]=a=>s(t).loader_fee=a),class:"input input-bordered w-full"},null,8,["readonly","value"]),s(t).errors.loader_fee?(c(),d("label",de,[e("span",ce,l(s(t).errors.loader_fee),1)])):m("",!0)]),e("div",pe,[e("button",{type:"submit",onClick:o[5]||(o[5]=a=>p.value=!0),class:"btn btn-primary"},"Simpan")])])],32),e("div",ue,[be,(c(!0),d(h,null,M(s(t).trades,(a,ge)=>(c(),d("div",{class:"grid grid-cols-5",key:a.id},[e("span",_e,l(a.trade_date),1),e("span",me,l(Intl.NumberFormat("id-ID",{style:"unit",unit:"kilogram"}).format(a.net_weight)),1),e("span",fe,l(Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s(t).loader_fee)),1),e("span",xe,l(Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a.net_weight*s(t).loader_fee)),1)]))),128)),e("div",ve,[he,e("span",ye,l(Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s(t).total)),1)])])])])])])],64))}};export{De as default};
