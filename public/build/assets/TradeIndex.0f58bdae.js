import{C as P,g as B,z as U,u as V,c as d,a as u,b as s,e as x,i as _,x as f,d as t,w as m,k as y,j as c,y as $,t as r,I as k,F as h,n as g,o as n,H as N,f as w,L as S,q as j,_ as M}from"./app.f33b5c0d.js";import{_ as E}from"./Breadcrumb.de4c8a73.js";import{_ as L}from"./PageTitle.dd8debfd.js";import{_ as R}from"./Pagination.e303f81d.js";import{s as A}from"./library.595eb791.js";const H={class:"modal modal-bottom sm:modal-middle"},K={class:"modal-box"},q=t("h3",{class:"font-bold text-lg"},"Lanjutkan input timbangan kebun?",-1),z=t("p",{class:"py-4"},"Proses, dan lanjutkan ke halaman input data timbangan kebun petani",-1),J={class:"modal-action"},O=t("label",{class:"btn btn-warning",for:"modal-save"},"Batal",-1),G={class:"modal modal-bottom sm:modal-middle"},Q={class:"modal-box"},W=t("h3",{class:"font-bold text-lg"},"Lanjutkan input timbangan atau hapus",-1),X={class:"modal-action flex justify-between"},Y=["disabled","onClick"],Z={class:"flex space-x-2"},tt=t("label",{class:"btn btn-warning",for:"modal-trade"},"Batal",-1),et={class:"px-4 grid gap-4"},st={class:"card w-full rounded-none border-2 border-info shadow-xl"},at={class:"card-body grid md:grid-cols-4 gap-4"},ot={class:"form-control w-full"},lt=t("label",{class:"label"},[t("span",{class:"label-text"},"Tanggal Transaksi")],-1),rt=["readonly"],nt={key:0,class:"label"},dt={class:"label-text-alt text-error"},it={class:"form-control w-full"},ct=t("label",{class:"label"},[t("span",{class:"label-text"},"Mobil")],-1),pt=["disabled"],ut=t("option",{value:"0"},"Pilih Mobil",-1),_t=["value"],bt={key:0,class:"label"},ht={class:"label-text-alt text-error"},mt={class:"form-control w-full"},gt=t("label",{class:"label"},[t("span",{class:"label-text"},"Supir")],-1),vt=["disabled"],xt=t("option",{value:"0"},"Pilih Supir",-1),ft=["value"],yt={key:0,class:"label"},kt={class:"label-text-alt text-error"},wt={class:"form-control w-full"},Tt=t("label",{class:"label"},[t("span",{class:"label-text"},"Uang Jalan")],-1),Ft={key:0,class:"label"},It={class:"label-text-alt text-error"},Ct={class:"card-actions justify-end p-8"},Dt=["disabled"],Pt={class:"card w-full rounded-none border-2 border-info shadow-xl"},Bt={class:"card-body"},Ut={class:"w-full text-left text-base"},Vt=t("thead",{class:"text-sm uppercase bg-primary/20"},[t("tr",null,[t("th",{class:"py-3 px-6",rowspan:"2"},"#"),t("th",{class:"py-3 px-6",rowspan:"2"},"Tanggal"),t("th",{class:"py-3 px-6",rowspan:"2"},"Supir"),t("th",{class:"py-3 px-6",rowspan:"2"},"Petani"),t("th",{class:"py-3 px-6 border-b border-primary-content text-center",colspan:"2"},"Timbangan Kebun "),t("th",{class:"py-3 px-6 border-b border-primary-content text-center",colspan:"2"},"Timbangan Pabrik "),t("th",{class:"py-3 px-6",rowspan:"2"})]),t("tr",null,[t("th",{class:"py-3 px-6 text-right"},"Tonase"),t("th",{class:"py-3 px-6 text-right"},"Total"),t("th",{class:"py-3 px-6 text-right"},"Tonase"),t("th",{class:"py-3 px-6 text-right"},"Total")])],-1),$t=["onClick"],Nt={class:"group-hover:bg-base-300 py-4 px-6"},St={class:"group-hover:bg-base-300 py-4 px-6"},jt={class:"group-hover:bg-base-300 py-4 px-6"},Mt={class:"font-bold"},Et={class:"text-sm opacity-50"},Lt={class:"group-hover:bg-base-300 py-4 px-6 text-center"},Rt={class:"group-hover:bg-base-300 py-4 px-6 text-right"},At={class:"group-hover:bg-base-300 py-4 px-6 text-right"},Ht={class:"group-hover:bg-base-300 py-4 px-6 text-right"},Kt={class:"group-hover:bg-base-300 py-4 px-6 text-right"},qt={class:"group-hover:bg-base-300 py-4 px-6"},Xt={__name:"TradeIndex",props:{cars:Array,drivers:Array,trades:Object},setup(T){const i=T,F=[{url:route("transaction.index"),label:"Transaksi"},{url:null,label:"Beli Sawit Petani"}],l=P({save:!1,trade:!1,selected:null,deleted:!1}),v=B();U(l,p=>{p.save&&setTimeout(function(){v.value.focus()},100),p.trade||(l.selected=null)});const a=V({date:null,car_id:0,driver_id:0,trade_cost:0}),I=()=>{a.post(route("transaction.trade.store"),{onFinish:()=>{l.save=!1}})},C=p=>{var o;l.trade=!0,l.selected=i.trades.data[p],l.deleted=l.selected===null||((o=l.selected)==null?void 0:o.details.length)>0},D=()=>{a.delete(route("transaction.trade.delete",l.selected.id),{onFinish:()=>{l.trade=!1}})};return(p,o)=>(n(),d(h,null,[u(s(N),{title:"Beli Sawit Petani"}),u(E,{links:F}),u(L,{classes:"bg-base-content"},{default:x(()=>[w("Beli Sawit Petani")]),_:1}),_(t("input",{id:"modal-save","onUpdate:modelValue":o[0]||(o[0]=e=>l.save=e),class:"modal-toggle",type:"checkbox"},null,512),[[f,l.save]]),t("div",H,[t("div",K,[q,z,t("div",J,[t("button",{ref_key:"btn_save",ref:v,class:"btn",type:"button",onClick:I},"Proses",512),O])])]),_(t("input",{id:"modal-trade","onUpdate:modelValue":o[1]||(o[1]=e=>l.trade=e),class:"modal-toggle",type:"checkbox"},null,512),[[f,l.trade]]),t("div",G,[t("div",Q,[W,t("div",X,[t("button",{disabled:l.deleted||s(a).processing,class:"btn btn-error",onClick:m(D,["prevent"]),type:"button"},"Hapus",8,Y),t("div",Z,[l.selected?(n(),y(s(S),{key:0,disabled:s(a).processing,href:p.route("transaction.trade.edit",l.selected.id),as:"button",class:"btn",type:"button"},{default:x(()=>[w("Tambah / Edit ")]),_:1},8,["disabled","href"])):c("",!0),tt])])])]),t("section",et,[t("div",st,[t("form",null,[t("div",at,[t("div",ot,[lt,_(t("input",{"onUpdate:modelValue":o[2]||(o[2]=e=>s(a).date=e),readonly:s(a).processing,class:"input input-info input-bordered w-full",type:"date",onFocus:o[3]||(o[3]=e=>s(a).clearErrors("date"))},null,40,rt),[[$,s(a).date]]),s(a).errors.date?(n(),d("label",nt,[t("span",dt,r(s(a).errors.date),1)])):c("",!0)]),t("div",it,[ct,_(t("select",{"onUpdate:modelValue":o[4]||(o[4]=e=>s(a).car_id=e),disabled:s(a).processing,class:"select select-info select-bordered",onFocus:o[5]||(o[5]=e=>s(a).clearErrors("car_id"))},[ut,(n(!0),d(h,null,g(i.cars,(e,b)=>(n(),d("option",{key:e.id,value:e.id},r(e.text.toUpperCase()),9,_t))),128))],40,pt),[[k,s(a).car_id]]),s(a).errors.car_id?(n(),d("label",bt,[t("span",ht,r(s(a).errors.car_id),1)])):c("",!0)]),t("div",mt,[gt,_(t("select",{"onUpdate:modelValue":o[6]||(o[6]=e=>s(a).driver_id=e),disabled:s(a).processing,class:"select select-info select-bordered",onFocus:o[7]||(o[7]=e=>s(a).clearErrors("driver_id"))},[xt,(n(!0),d(h,null,g(i.drivers,(e,b)=>(n(),d("option",{key:e.id,value:e.id},r(e.text.toUpperCase()),9,ft))),128))],40,vt),[[k,s(a).driver_id]]),s(a).errors.driver_id?(n(),d("label",yt,[t("span",kt,r(s(a).errors.driver_id),1)])):c("",!0)]),t("div",wt,[Tt,u(s(A),{value:s(a).trade_cost,"onUpdate:value":o[8]||(o[8]=e=>s(a).trade_cost=e),options:{precision:0,prefix:"Rp ",isInteger:!0},readonly:s(a).processing,class:"input input-info input-bordered w-full"},null,8,["value","readonly"]),s(a).errors.trade_cost?(n(),d("label",Ft,[t("span",It,r(s(a).errors.trade_cost),1)])):c("",!0)])]),t("div",Ct,[t("button",{disabled:s(a).processing,class:"btn btn-primary",onClick:o[9]||(o[9]=m(e=>l.save=!0,["prevent"]))},"Input Timbangan Kebun ",8,Dt)])])]),t("div",Pt,[t("div",Bt,[t("table",Ut,[Vt,t("tbody",null,[i.trades.data.length?(n(!0),d(h,{key:0},g(i.trades.data,(e,b)=>(n(),d("tr",{class:"hover:cursor-pointer group border-b",onClick:m(zt=>C(b),["prevent"])},[t("th",Nt,r(i.trades.from+b),1),t("td",St,r(e.trade_date),1),t("td",jt,[t("div",null,[t("div",Mt,r(e.driver.name),1),t("div",Et,r(e.car.no_pol),1)])]),t("td",Lt,r(e.details.length)+" Petani",1),t("td",Rt,r(Intl.NumberFormat("id-ID",{style:"unit",unit:"kilogram"}).format(e.gross_weight)),1),t("td",At,r(Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(e.gross_total)),1),t("td",Ht,r(Intl.NumberFormat("id-ID",{style:"unit",unit:"kilogram"}).format(e.net_weight)),1),t("td",Kt,r(Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(e.net_total)),1),t("td",qt,[u(M,{path:s(j)},null,8,["path"])])],8,$t))),256)):c("",!0)])]),i.trades.data.length?(n(),y(R,{key:0,links:i.trades.links},null,8,["links"])):c("",!0)])])])],64))}};export{Xt as default};
