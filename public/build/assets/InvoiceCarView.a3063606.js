import{g as k,u as N,h as D,z as C,c,a as n,b as s,e as F,i as b,x as T,d as e,_,f as u,w as S,y as v,t as r,j as m,F as h,n as M,G as V,o as d,H as R,Q as j,J as A,R as B,S as U}from"./app.f33b5c0d.js";import{_ as $}from"./Breadcrumb.de4c8a73.js";import{_ as H}from"./PageTitle.dd8debfd.js";import{s as O}from"./library.595eb791.js";const P={for:"modal-option",class:"modal cursor-pointer modal-lg"},K={class:"modal-box w-11/12 max-w-3xl",for:""},z={class:"flex justify-between"},E={class:"px-6 w-full"},G={class:"card w-full rounded-none border-2 border-info shadow-xl"},J={class:"card-body"},L={class:"flex justify-between space-x-4 items-start"},Q={class:"grid md:grid-cols-2 gap-4 print:hidden"},q={class:"form-control w-full col-span-2"},W=e("label",{class:"label"},"No Nota / Invoice",-1),X={key:0,class:"label"},Y={class:"label-text-alt text-error"},Z={class:"form-control w-full"},ee=e("label",{class:"label"},"Tanggal Nota / Invoice",-1),te=["readonly"],se={key:0,class:"label"},ae={class:"label-text-alt text-error"},oe={class:"form-control w-full"},re=e("label",{class:"label"},"Amprah Mobil (Rp / Kg)",-1),ne={key:0,class:"label"},le={class:"label-text-alt text-error"},ie={class:"flex justify-between col-span-2"},ce={class:"grid text-sm grid-cols-1 w-[50%] print:w-[100%]"},de=V('<div class="grid grid-cols-5"><span class="font-bold text-center px-4 py-2 border-l border-y col-span-2">Tanggal / Keterangan</span><span class="font-bold text-center px-4 py-2 border-l border-y">Banyaknya</span><span class="font-bold text-center px-4 py-2 border-l border-y">Harga</span><span class="font-bold text-center px-4 py-2 border-x border-y">Total</span></div><div class="grid grid-cols-5"><span class="px-4 py-2 border-l font-bold col-span-2">Pembelian Sawit</span><span class="px-4 py-2 border-l"></span><span class="px-4 py-2 border-l"></span><span class="px-4 py-2 border-x"></span></div>',2),pe={class:"px-4 border-l col-span-2"},ue={class:"px-4 border-l text-right"},be={class:"px-4 border-l text-right"},_e={class:"px-4 border-x text-right"},me={class:"grid grid-cols-5 border-y font-bold"},fe=e("span",{class:"px-4 py-2 border-l text-right col-span-4"},"Total Diterima",-1),xe={class:"px-4 py-2 border-x text-right"},Ie={__name:"InvoiceCarView",props:{car:Object},setup(y){const l=y,g=[{url:route("transaction.index"),label:"Transaksi"},{url:route("transaction.invoice.index"),label:"Invoice"},{url:route("transaction.invoice.car.index"),label:"Amprah Mobil"},{url:null,label:l.car.name.toUpperCase()}],p=k(!1),t=N({print:!1,invoice_date:"",invoice_number:"OTOMATIS",car_id:l.car.id,trades:l.car.trades,car_fee:l.car.price?l.car.price.value:0,total:0}),f=()=>{t.patch(route("transaction.invoice.car.update",l.car.id),{onFinish:()=>{p.value=!1}})},w=()=>{t.print=!1,f()},I=()=>{t.print=!0,f()};D(()=>{x()}),C(()=>U.cloneDeep(t),(i,a)=>{i.car_fee&&x()});const x=()=>{let i=t.trades.reduce((a,o)=>(a.push(o.net_weight*t.car_fee),a),[]);i=i.reduce((a,o)=>a+=o,0),t.total=i};return(i,a)=>(d(),c(h,null,[n(s(R),{title:"Amprah Mobil"}),n($,{links:g}),n(H,{classes:"bg-base-content",class:""},{default:F(()=>[u("Amprah Mobil ")]),_:1}),b(e("input",{type:"checkbox",id:"modal-option","onUpdate:modelValue":a[0]||(a[0]=o=>p.value=o),class:"modal-toggle"},null,512),[[T,p.value]]),e("label",P,[e("label",K,[e("div",z,[e("button",{type:"button",onClick:w,class:"btn btn-primary"},[n(_,{path:s(j)},null,8,["path"]),u(" Simpan")]),e("button",{type:"button",onClick:I,class:"btn btn-success"},[n(_,{path:s(A)},null,8,["path"]),u(" Simpan dan Print Invoice")]),e("button",{type:"button",onClick:a[1]||(a[1]=o=>p.value=!1),class:"btn btn-warning"},[n(_,{path:s(B)},null,8,["path"]),u(" Batal")])])])]),e("section",E,[e("div",G,[e("div",J,[e("div",L,[e("form",{onSubmit:a[6]||(a[6]=S(()=>{},["prevent"])),class:"w-[50%]"},[e("div",Q,[e("div",q,[W,b(e("input",{disabled:"","onUpdate:modelValue":a[2]||(a[2]=o=>s(t).invoice_number=o),type:"text",placeholder:"No Nota / Invoice",class:"input input-bordered w-full"},null,512),[[v,s(t).invoice_number]]),s(t).errors.invoice_number?(d(),c("label",X,[e("span",Y,r(s(t).errors.invoice_number),1)])):m("",!0)]),e("div",Z,[ee,b(e("input",{readonly:s(t).processing,"onUpdate:modelValue":a[3]||(a[3]=o=>s(t).invoice_date=o),type:"date",placeholder:"Tanggal Nota / Invoice",class:"input input-bordered w-full"},null,8,te),[[v,s(t).invoice_date]]),s(t).errors.invoice_date?(d(),c("label",se,[e("span",ae,r(s(t).errors.invoice_date),1)])):m("",!0)]),e("div",oe,[re,n(s(O),{options:{precision:0,prefix:"Rp ",isInteger:!0},readonly:s(t).processing,value:s(t).car_fee,"onUpdate:value":a[4]||(a[4]=o=>s(t).car_fee=o),class:"input input-bordered w-full"},null,8,["readonly","value"]),s(t).errors.car_fee?(d(),c("label",ne,[e("span",le,r(s(t).errors.car_fee),1)])):m("",!0)]),e("div",ie,[e("button",{type:"submit",onClick:a[5]||(a[5]=o=>p.value=!0),class:"btn btn-primary"},"Simpan")])])],32),e("div",ce,[de,(d(!0),c(h,null,M(s(t).trades,(o,ve)=>(d(),c("div",{class:"grid grid-cols-5",key:o.id},[e("span",pe,r(o.trade_date),1),e("span",ue,r(Intl.NumberFormat("id-ID",{style:"unit",unit:"kilogram"}).format(o.net_weight)),1),e("span",be,r(Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s(t).car_fee)),1),e("span",_e,r(Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(o.net_weight*s(t).car_fee)),1)]))),128)),e("div",me,[fe,e("span",xe,r(Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(s(t).total)),1)])])])])])])],64))}};export{Ie as default};
