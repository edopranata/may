import{g as F,u as N,h as P,c as l,a as i,b as t,e as T,i as _,x as C,d as s,_ as m,f as b,w as j,y as h,t as a,j as d,F as f,n as R,s as g,G as S,o as r,H as V,Q as B,J as U,R as M}from"./app.f33b5c0d.js";import{_ as $}from"./Breadcrumb.de4c8a73.js";import{_ as H}from"./PageTitle.dd8debfd.js";import{s as y}from"./library.595eb791.js";const O={for:"modal-option",class:"modal cursor-pointer modal-lg"},A={class:"modal-box w-11/12 max-w-3xl",for:""},z={class:"flex justify-between"},E=["disabled"],G=["disabled"],J=["disabled"],K={class:"px-4 grid gap-4"},L={class:"card w-full rounded-none border-2 border-info shadow-xl"},Q={class:"card-body"},q={class:"flex justify-between space-x-4 items-start"},W={class:"grid md:grid-cols-2 gap-4 print:hidden"},X={class:"form-control w-full"},Y=s("label",{class:"label"},"No Nota / Invoice",-1),Z={key:0,class:"label"},ss={class:"label-text-alt text-error"},ts={class:"form-control w-full"},es=s("label",{class:"label"},"Tanggal Nota / Invoice",-1),os=["readonly"],ns={key:0,class:"label"},as={class:"label-text-alt text-error"},ls={class:"form-control w-full"},rs=s("label",{class:"label"},"Pinjaman",-1),is={key:0,class:"label"},ds={class:"label-text-alt text-error"},cs={class:"form-control w-full"},ps=s("label",{class:"label"},"Angsuran Pinjaman",-1),us={key:0,class:"label"},bs={class:"label-text-alt text-error"},_s={class:"flex justify-between col-span-2"},ms={class:"grid text-sm grid-cols-1 w-[50%] print:w-[100%]"},xs=S('<div class="grid grid-cols-5"><span class="font-bold text-center px-4 py-2 border-l border-y col-span-2">Tanggal / Keterangan</span><span class="font-bold text-center px-4 py-2 border-l border-y">Banyaknya</span><span class="font-bold text-center px-4 py-2 border-l border-y">Harga</span><span class="font-bold text-center px-4 py-2 border-x border-y">Total</span></div><div class="grid grid-cols-5"><span class="px-4 py-2 border-l font-bold col-span-2">Pembelian Sawit</span><span class="px-4 py-2 border-l"></span><span class="px-4 py-2 border-l"></span><span class="px-4 py-2 border-x"></span></div>',2),hs={class:"px-4 border-l col-span-2"},fs={class:"px-4 border-l text-right"},gs={class:"px-4 border-l text-right"},ys={class:"px-4 border-x text-right"},vs=s("span",{class:"px-4 pb-4 border-l col-span-2"},null,-1),Is=s("span",{class:"px-4 pb-4 border-l"},null,-1),ws=s("span",{class:"px-4 pb-4 border-l"},null,-1),Ds={class:"px-4 pb-4 border-x text-right font-bold"},ks={key:0,class:"grid grid-cols-5"},Fs=s("span",{class:"px-4 border-l font-bold col-span-2"},"Potongan",-1),Ns=s("span",{class:"px-4 border-l"},null,-1),Ps=s("span",{class:"px-4 border-l"},null,-1),Ts=s("span",{class:"px-4 border-x text-right font-bold"},null,-1),Cs=[Fs,Ns,Ps,Ts],js={key:1,class:"grid grid-cols-5"},Rs=s("span",{class:"px-4 border-l col-span-2"},"Pinjaman Terakhir",-1),Ss=s("span",{class:"px-4 border-l"},null,-1),Vs=s("span",{class:"px-4 border-l"},null,-1),Bs={class:"px-4 border-x text-right font-bold"},Us={key:2,class:"grid grid-cols-5"},Ms=s("span",{class:"px-4 border-l col-span-2"},"Bayar Pinjaman",-1),$s=s("span",{class:"px-4 border-l"},null,-1),Hs=s("span",{class:"px-4 border-l"},null,-1),Os={class:"px-4 border-x text-right"},As=s("span",{class:"px-4 border-l font-bold col-span-2"},"Sisa Pinjaman",-1),zs=s("span",{class:"px-4 border-l"},null,-1),Es=s("span",{class:"px-4 border-l"},null,-1),Gs={class:"px-4 border-x text-right font-bold"},Js={class:"grid grid-cols-5 border-b font-bold"},Ks=s("span",{class:"px-4 py-2 border-l text-right col-span-4"},"Total Diterima",-1),Ls={class:"px-4 py-2 border-x text-right"},Zs={__name:"InvoiceFarmerView",props:{farmer:Object},setup(v){const c=v,I=[{url:route("transaction.index"),label:"Transaksi"},{url:route("transaction.invoice.index"),label:"Invoice"},{url:route("transaction.invoice.farmer.index"),label:"Invoice Petani"},{url:null,label:c.farmer.name.toUpperCase()}],p=F(!1),e=N({print:!1,invoice_date:"",invoice_number:"OTOMATIS",farmer_id:c.farmer.id,trades:c.farmer.trades,loan:c.farmer.loan?c.farmer.loan.balance:0,total:0,installment:0}),x=()=>{e.patch(route("transaction.invoice.farmer.update",c.farmer.id),{onFinish:()=>{p.value=!1}})},w=()=>{e.print=!1,x()},D=()=>{e.print=!0,x()};P(()=>{k()});const k=()=>{let u=e.trades.reduce((n,o)=>(n.push(o.total),n),[]);u=u.reduce((n,o)=>n+=o,0),e.total=u};return(u,n)=>(r(),l(f,null,[i(t(V),{title:"Invoice Petani"}),i($,{links:I}),i(H,{classes:"bg-base-content",class:""},{default:T(()=>[b("Invoice Petani ")]),_:1}),_(s("input",{type:"checkbox",id:"modal-option","onUpdate:modelValue":n[0]||(n[0]=o=>p.value=o),class:"modal-toggle"},null,512),[[C,p.value]]),s("label",O,[s("label",A,[s("div",z,[s("button",{type:"button",disabled:t(e).processing,onClick:w,class:"btn btn-primary"},[i(m,{path:t(B)},null,8,["path"]),b(" Simpan")],8,E),s("button",{type:"button",disabled:t(e).processing,onClick:D,class:"btn btn-success"},[i(m,{path:t(U)},null,8,["path"]),b(" Simpan dan Print Invoice")],8,G),s("button",{type:"button",disabled:t(e).processing,onClick:n[1]||(n[1]=o=>p.value=!1),class:"btn btn-warning"},[i(m,{path:t(M)},null,8,["path"]),b(" Batal")],8,J)])])]),s("section",K,[s("div",L,[s("div",Q,[s("div",q,[s("form",{onSubmit:n[7]||(n[7]=j(()=>{},["prevent"])),class:"w-[50%]"},[s("div",W,[s("div",X,[Y,_(s("input",{disabled:"","onUpdate:modelValue":n[2]||(n[2]=o=>t(e).invoice_number=o),type:"text",placeholder:"No Nota / Invoice",class:"input input-bordered w-full"},null,512),[[h,t(e).invoice_number]]),t(e).errors.invoice_number?(r(),l("label",Z,[s("span",ss,a(t(e).errors.invoice_number),1)])):d("",!0)]),s("div",ts,[es,_(s("input",{readonly:t(e).processing,"onUpdate:modelValue":n[3]||(n[3]=o=>t(e).invoice_date=o),type:"date",placeholder:"Tanggal Nota / Invoice",class:"input input-bordered w-full"},null,8,os),[[h,t(e).invoice_date]]),t(e).errors.invoice_date?(r(),l("label",ns,[s("span",as,a(t(e).errors.invoice_date),1)])):d("",!0)]),s("div",ls,[rs,i(t(y),{options:{precision:0,prefix:"Rp ",isInteger:!0},readonly:t(e).processing,value:t(e).loan,"onUpdate:value":n[4]||(n[4]=o=>t(e).loan=o),class:"input input-bordered w-full"},null,8,["readonly","value"]),t(e).errors.loan?(r(),l("label",is,[s("span",ds,a(t(e).errors.loan),1)])):d("",!0)]),s("div",cs,[ps,i(t(y),{options:{precision:0,prefix:"Rp ",isInteger:!0},readonly:t(e).processing,value:t(e).installment,"onUpdate:value":n[5]||(n[5]=o=>t(e).installment=o),class:"input input-bordered w-full"},null,8,["readonly","value"]),t(e).errors.installment?(r(),l("label",us,[s("span",bs,a(t(e).errors.installment),1)])):d("",!0)]),s("div",_s,[s("button",{type:"submit",onClick:n[6]||(n[6]=o=>p.value=!0),class:"btn btn-primary"},"Simpan")])])],32),s("div",ms,[xs,(r(!0),l(f,null,R(t(e).trades,(o,Qs)=>(r(),l("div",{class:"grid grid-cols-5",key:o.id},[s("span",hs,a(o.trade.trade_date),1),s("span",fs,a(Intl.NumberFormat("id-ID",{style:"unit",unit:"kilogram"}).format(o.weight)),1),s("span",gs,a(Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(o.price)),1),s("span",ys,a(Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(o.weight*o.price)),1)]))),128)),s("div",{class:g(["grid grid-cols-5",t(e).loan?"":"border-b"])},[vs,Is,ws,s("span",Ds,a(Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(t(e).total)),1)],2),t(e).loan?(r(),l("div",ks,Cs)):d("",!0),t(e).loan?(r(),l("div",js,[Rs,Ss,Vs,s("span",Bs,a(Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(t(e).loan)),1)])):d("",!0),t(e).loan?(r(),l("div",Us,[Ms,$s,Hs,s("span",Os,a(Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(t(e).installment?t(e).installment*-1:0)),1)])):d("",!0),t(e).loan?(r(),l("div",{key:3,class:g(["grid grid-cols-5",t(e).loan>1?"border-b":""])},[As,zs,Es,s("span",Gs,a(Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(t(e).loan-t(e).installment)),1)],2)):d("",!0),s("div",Js,[Ks,s("span",Ls,a(Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(t(e).total-t(e).installment)),1)])])])])])])],64))}};export{Zs as default};
