import{g as b,z as h,u as w,c as d,a as u,b as e,e as $,i as f,x as k,d as t,y as R,w as T,t as r,j as m,F as I,n as E,o as c,H,f as M,s as j,q as A,_ as K,S as P}from"./app.1b38ef22.js";import{_ as z}from"./Breadcrumb.cb73cb46.js";import{_ as q}from"./PageTitle.0dcaf6ba.js";import{s as J}from"./multiselect.dfec50e8.js";import{s as g}from"./library.2a2b5b59.js";const L={class:"modal modal-bottom sm:modal-middle"},O={class:"modal-box"},G=t("h3",{class:"font-bold text-lg"},"Data timbangan sudah benar?",-1),Q=t("p",{class:"py-4"},"Simpan data dan lanjut tambahkan data timbangan yang lainnya",-1),W={class:"modal-action"},X=["disabled"],Y=t("label",{for:"modal-save",class:"btn btn-warning"},"Batal",-1),Z={class:"modal modal-bottom sm:modal-middle"},tt={class:"modal-box"},et={key:0,class:"font-bold text-lg"},st={key:1,class:"font-bold text-lg"},at={class:"modal-action"},ot=["disabled"],lt=t("label",{for:"modal-delete",class:"btn btn-warning"},"Batal",-1),rt={class:"px-4 grid gap-4"},nt={class:"card w-full rounded-none border-2 border-info shadow-xl"},it={class:"card-body grid md:grid-cols-3 gap-4"},dt={class:"form-control w-full"},ct=t("label",{class:"label"},[t("span",{class:"label-text"},"Tanggal Transaksi")],-1),ut={class:"form-control w-full"},pt=t("label",{class:"label"},[t("span",{class:"label-text"},"Mobil")],-1),_t=["value"],bt={class:"form-control w-full"},mt=t("label",{class:"label"},[t("span",{class:"label-text"},"Supir")],-1),ht=["value"],ft={class:"card w-full rounded-none border-2 border-info shadow-xl"},gt={class:"grid md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4"},vt={class:"form-control w-full md:col-span-2 lg:col-span-3 xl:col-span-2"},xt=t("label",{class:"label"},[t("span",{class:"label-text"},"Nama Petani")],-1),yt={class:"label h-8"},wt={key:0,class:"label-text-alt text-error"},kt={class:"form-control w-full"},Tt=t("label",{class:"label"},[t("span",{class:"label-text"},"Berat")],-1),It={class:"label h-8"},Dt={key:0,class:"label-text-alt text-error"},Ft={class:"form-control w-full"},Ct=t("label",{class:"label"},[t("span",{class:"label-text"},"Harga Beli")],-1),Ut={class:"label h-8"},Bt={key:0,class:"label-text-alt text-error"},Nt={class:"form-control w-full"},Vt=t("label",{class:"label"},[t("span",{class:"label-text"},"Total")],-1),St={class:"form-control w-full"},$t={class:"form-control w-full pt-9"},Rt=["disabled"],Et={class:"w-full overflow-y-auto mt-10 md:mt-0"},Ht={class:"w-full text-left text-base min-w-4xl"},Mt=t("thead",{class:"text-sm uppercase bg-primary/20"},[t("tr",null,[t("th",{class:"py-3 px-6"},"#"),t("th",{class:"py-3 px-6"},"Petani"),t("th",{class:"py-3 px-6 text-right"},"Berat"),t("th",{class:"py-3 px-6 text-right"},"Harga"),t("th",{class:"py-3 px-6 text-right"},"Total"),t("th",{class:"py-3 px-6"},"Invoice")])],-1),jt=["onClick"],At={class:"group-hover:bg-base-300 py-4 px-6"},Kt={class:"group-hover:bg-base-300 py-4 px-6"},Pt={class:"font-bold"},zt={class:"text-sm opacity-50"},qt={class:"group-hover:bg-base-300 py-4 px-6 text-right"},Jt={class:"group-hover:bg-base-300 py-4 px-6 text-right"},Lt={class:"group-hover:bg-base-300 py-4 px-6 text-right"},Ot={class:"group-hover:bg-base-300 py-4 px-6"},Gt={class:"flex justify-between"},Qt={key:1,class:"border-t"},Wt=t("th",{class:"group-hover:bg-base-300 py-4 px-6 text-right",colspan:"2"},"Total",-1),Xt={class:"group-hover:bg-base-300 py-4 px-6 text-right"},Yt=t("td",{class:"group-hover:bg-base-300 py-4 px-6"},null,-1),Zt={class:"group-hover:bg-base-300 py-4 px-6 text-right"},te=t("td",{class:"group-hover:bg-base-300 py-4 px-6"},null,-1),ne={__name:"TradeCreate",props:{trade:Object,farmers:Array},setup(D){const l=D,F=[{url:route("transaction.index"),label:"Transaksi"},{url:route("transaction.trade.index"),label:"Beli Sawit Petani"},{url:null,label:"Timbangan Kebun "+l.trade.car.no_pol.toUpperCase()+" - "+l.trade.car.name.toUpperCase()}],p=b(!1),_=b(!1),v=b(),x=b(),C=b();h(p,n=>{n&&setTimeout(function(){v.value.focus()},100)}),h(_,n=>{n&&setTimeout(function(){x.value.focus()},100)});const s=w({date:l.trade.trade_date,farmer_id:0,weight:0,price:0,total:0}),i=w({id:0,farmer_id:0,status:!1}),U=n=>{let a=l.trade.details[n];i.id=a.id,i.farmer_id=a.farmer_id,i.status=!!a.farmer_status,_.value=!0};h(()=>P.cloneDeep(s),(n,a)=>{n.weight&&n.price&&(s.total=n.weight*n.price)});const B=()=>{s.patch(route("transaction.trade.update",l.trade.id),{onSuccess:()=>{V()},onFinish:()=>{p.value=!1}})},N=()=>{i.delete(route("transaction.trade.destroy",i.id),{onSuccess:()=>{S()},onFinish:()=>{_.value=!1}})},V=()=>{s.clearErrors(),s.reset(),s.defaults({date:l.trade.trade_date,farmer_id:0,weight:0,price:0,total:0}),p.value=!1,setTimeout(function(){C.value.focus()},300)},S=()=>{i.clearErrors(),i.reset(),i.defaults({id:0,farmer_id:0}),_.value=!1};return(n,a)=>(c(),d(I,null,[u(e(H),{title:"Transaksi Jual Beli"}),u(z,{links:F}),u(q,{classes:"bg-base-content",class:""},{default:$(()=>[M("Timbangan Kebun")]),_:1}),f(t("input",{type:"checkbox",id:"modal-save","onUpdate:modelValue":a[0]||(a[0]=o=>p.value=o),class:"modal-toggle"},null,512),[[k,p.value]]),t("div",L,[t("div",O,[G,Q,t("div",W,[t("button",{disabled:e(s).processing,ref_key:"btn_save",ref:v,type:"button",class:"btn",onClick:B},"Tambah",8,X),Y])])]),f(t("input",{type:"checkbox",id:"modal-delete","onUpdate:modelValue":a[1]||(a[1]=o=>_.value=o),class:"modal-toggle"},null,512),[[k,_.value]]),t("div",Z,[t("div",tt,[e(i).status?(c(),d("h3",et,"Tidak dapat dihapus, karena invoice telah terbit")):(c(),d("h3",st,"Apakah data ini akan di hapus?")),t("div",at,[t("button",{disabled:e(s).processing||e(i).status,ref_key:"btn_delete",ref:x,type:"button",class:"btn btn-error",onClick:N},"Hapus",8,ot),lt])])]),t("section",rt,[t("div",nt,[t("div",it,[t("div",dt,[ct,f(t("input",{readonly:"","onUpdate:modelValue":a[2]||(a[2]=o=>e(s).date=o),type:"date",class:"input input-info input-bordered w-full"},null,512),[[R,e(s).date]])]),t("div",ut,[pt,t("input",{readonly:"",type:"text",value:l.trade.car.no_pol.toUpperCase()+" - "+l.trade.car.name.toUpperCase(),class:"input input-info input-bordered w-full"},null,8,_t)]),t("div",bt,[mt,t("input",{readonly:"",type:"text",value:l.trade.driver.name.toUpperCase(),class:"input input-info input-bordered w-full"},null,8,ht)])])]),t("div",ft,[t("form",{onSubmit:a[9]||(a[9]=T(o=>p.value=!0,["prevent"])),class:"card-body"},[t("div",gt,[t("div",vt,[xt,u(e(J),{class:"select select-bordered rounded",searchable:!0,modelValue:e(s).farmer_id,"onUpdate:modelValue":a[3]||(a[3]=o=>e(s).farmer_id=o),options:l.farmers},null,8,["modelValue","options"]),t("label",yt,[e(s).errors.farmer_id?(c(),d("span",wt,r(e(s).errors.farmer_id),1)):m("",!0)])]),t("div",kt,[Tt,u(e(g),{onFocus:a[4]||(a[4]=o=>e(s).clearErrors("weight")),options:{precision:0,prefix:"",suffix:" Kg",isInteger:!0},readonly:e(s).processing,value:e(s).weight,"onUpdate:value":a[5]||(a[5]=o=>e(s).weight=o),class:"input input-bordered"},null,8,["readonly","value"]),t("label",It,[e(s).errors.weight?(c(),d("span",Dt,r(e(s).errors.weight),1)):m("",!0)])]),t("div",Ft,[Ct,u(e(g),{onFocus:a[6]||(a[6]=o=>e(s).clearErrors("price")),options:{precision:0,prefix:"Rp. ",suffix:"",isInteger:!0},readonly:e(s).processing,value:e(s).price,"onUpdate:value":a[7]||(a[7]=o=>e(s).price=o),class:"input input-bordered"},null,8,["options","readonly","value"]),t("label",Ut,[e(s).errors.price?(c(),d("span",Bt,r(e(s).errors.price),1)):m("",!0)])]),t("div",Nt,[Vt,t("div",St,[u(e(g),{options:{precision:0,prefix:"Rp. ",suffix:"",isInteger:!0},readonly:"",value:e(s).total,"onUpdate:value":a[8]||(a[8]=o=>e(s).total=o),class:"input input-bordered"},null,8,["options","value"])])]),t("div",$t,[t("button",{disabled:e(s).processing,type:"submit",class:"btn"},"Tambahkan",8,Rt)])]),t("div",Et,[t("table",Ht,[Mt,t("tbody",null,[l.trade.details.length?(c(!0),d(I,{key:0},E(l.trade.details,(o,y)=>(c(),d("tr",{class:"hover:cursor-pointer group border-b",onClick:T(ee=>U(y),["prevent"])},[t("td",At,r(y+1),1),t("td",Kt,[t("div",null,[t("div",Pt,r(o.farmer.name),1),t("div",zt,r(o.farmer.phone),1)])]),t("td",qt,r(Intl.NumberFormat("id-ID",{style:"unit",unit:"kilogram"}).format(o.weight)),1),t("td",Jt,r(Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(o.price)),1),t("td",Lt,r(Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(o.total)),1),t("td",Ot,[t("div",Gt,[t("span",{class:j(["badge badge-lg",o.farmer_status?"badge-success":"badge-error"])},r(o.farmer_status?"Terbit":"Belum"),3),u(K,{path:e(A)},null,8,["path"])])])],8,jt))),256)):m("",!0),l.trade.details.length?(c(),d("tr",Qt,[Wt,t("th",Xt,r(Intl.NumberFormat("id-ID",{style:"unit",unit:"kilogram"}).format(l.trade.gross_weight)),1),Yt,t("th",Zt,r(Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(l.trade.gross_total)),1),te])):m("",!0)])])])],32)])])],64))}};export{ne as default};
